\documentclass[openany,a4paper,11pt]{memoir}
\usepackage{amsmath,amssymb,bm,amsthm}
\usepackage{textcomp}

\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}

\newcommand\restr[2]{{% we make the whole thing an ordinary symbol
  \left.\kern-\nulldelimiterspace % automatically resize the bar with \right
  #1 % the function
  \vphantom{\big|} % pretend it's a little taller at normal size
  \right|_{#2} % this is the delimiter
  }}

\begin{document}

\chapter{$P_1$ Finite elements on triangles - tetraedrons}
Let $V=H^0_0\left(\Omega\right)$. We consider the Poisson problem $u\in H^1_0\left(\Omega\right)$ \[-\Delta u=f\text{ in }\Omega \] and its weak formulation % Convection field
\section{Lecture $2$: Accuracy of Finite Element Discretizations}

\textbf{Outline for today:}

\begin{enumerate}
\item A priori error estimates in $H^{1}$ \[ {\|\nabla(u-u_h)\|}_{L^{2}(h)}. \]
\end{enumerate}

$C$ dependes of the solution. One is usually intereset in the error \[ {\|u-u_{h}\|}_{X}=? \] for a certain norm $\|\cdot\|_{X}$.
\begin{itemize}
\item \textbf{A priori error estimates:}\\ Information about the error in terms of mesh size asymptotics, e.g, for $P_{1}$ or $Q_{1}$ elements
  \begin{align*}
    \|\nabla\left(u-u_{h}\right)\|_{L^{2}(h)}&\le ch{|u|}_{H^{2}(\Omega)} \\
    \|u-u_{h}\|_{L^{2}(\Omega)}&\le ch^{2}{|u|}_{H^2(\Omega)}
  \end{align*}
\item \textbf{A posteriori error estimates:} Information about the error in terms of $u_{h}$, e.g, \[ \|\nabla(u-u_{h})\|^{2}_{L^{2}(\Omega)}\le \sum_{}\]
\end{itemize}

\section{Galerkin Orthogonality}

\begin{itemize}
\item Continuous problem with $A\colon V\times V\rightarrow\mathbb{R}$ bilinear: \[ u\in V\colon A\left(u,\phi\right)=\left(f,\phi\right)\quad\forall\phi\in V. \] Most simple example: \[ A\left(u,\phi\right)=\left(\nabla u,\nabla\phi\right)=\int_{\Omega}\nabla u\nabla\phi\mathrm{d}x \]
\item Discrete problem: \[ u_{h}\in V_{N}\colon A\left(u_h,\phi\right)=\left(f,\phi\right)\quad\forall\phi\in V_{h}. \]
  
\item Discretization error \[ e_{h}= \]
\end{itemize}

\section{Cea\textquotesingle s lemma}

Suppose that the bilinear form $A\colon V\times V\rightarrow\mathbb{R}$ satisfies the conditions of \linebreak Lax-Milgram\textquotesingle s theorem (continuous and $V$-coercive with $\alpha_{1},\alpha_{2}>0$). Further, let $V_{h}\subseteq V$ a subspace. Then: \[ \|u-u_{h}\|_{V}\le \frac{\alpha_{1}}{\alpha_{2}}\inf_{v_h\in V}\]

\section{Continuity and coercivity}

\begin{itemize}
\item \textbf{Continuity:} There exists $\alpha_{1}\ge 0$ such that. \[ A\left(u,\phi\right)\le\alpha_{1} \]
\end{itemize}

\section{Proof of Cea\textquotesingle s lemma}

Let $v_{h}\in V_{h}$ be arbitrary,
\begin{align*}
  \alpha_{2}{\|u-u_{h}\|}^{2}_{V}&\le A\left(u-u_{h}, u-u_{h}\right)\quad (\text{ coercivity })\\
  &\\
\end{align*}

\begin{itemize}
\item $V=H^{1}_{0}(\Omega)$.
\item associated norm \[ \|u\|_{V}={\|\nabla u\|}_{\Omega}={\left(\int_{\Omega}{|\nabla u(x)|}^{2}\mathrm{d}x\right)}^{1/2} \]
\item $\alpha_{1}=\alpha_{2}=1$ \[ {\|\nabla\left(u-u_{h}\right)\|}_{\Omega}=\inf_{v_h\in V_h}{\|\nabla\left(u-v_h\right)\|}_{\Omega} \]
\end{itemize}

\section{Interpolation error}

\begin{itemize}
\item Let $I_{h}\colon V\rightarrow V_{h}$ be an arbitrary interpolation. Then
  \begin{align*}
    \|u-u_h\|_{V}\le \frac{\alpha_1}{\alpha_2}\inf_{v_h\in V_h}\|u-v_h\|_{V}\\
    \le \frac{\alpha_1}{\alpha_2}\|u-I_hu\|_{V}
  \end{align*}
  
\item We only need do get and idea about the interpolation error \[ {\|u-I_hu\|}_{V}\]
  
\item Most simple is the nodal interpolation of continuous functions \[ I_hu(N)=u(N). \] for nodes $N$ of the mesh.
  
\item But: Are $H^1(\Omega)$ functions continuuous?
  \[d=1\quad (\text{yes})\qquad d\ge 2\quad(\text{no}) \]
\end{itemize}

\section{More regular Sobolev functions}
\begin{itemize}
\item Higher orden Sobolev spaces of order $k\ge 1$: \[ H^{k}(\Omega)= \]
\end{itemize}

\section{$H^2$ functions are continuous}
\begin{itemize}
\item For $d=1$ \[ H^1(\Omega)\subseteq C(\Omega) \]
  
\item For $d=2$ and $d=3$ \[ H^2(\Omega)\subseteq C(\Omega) \]
  
\item If $\partial\Omega$ is Lipschitz \ldots
\end{itemize}

\section{Nodal interpolation of $H^{2}$-functions}

Hence, if $u\in H^2(\Omega)$, then it holds for the Poisson pb \[\|\nabla (u-I_h)\| \]

\section{Structure to addres the interpolation error}

\begin{enumerate}
\item Location: \[ \|\nabla(u-I_h u) \|^2_{\Omega}=\sum_{T\in T_h}\|\nabla(u-I_h u)\|^2_{T} \]
  
\item Transformation to the reference cell: \[\|\nabla(u-I_h)\| \]
\end{enumerate}

\section{Step $2$: Transformation to the reference cell}

How to transform an expression as $(w=u-I_h u)$ \[\|\nabla(u-I_h u)\|^2_{T}=\int_{T}|\nabla w(x)|^2\mathrm{d}x \] onto the reference triangle $\hat{T}$ by an affine linear transformation \[\phi_T(\hat{x})=x_0+B_T\hat{x} \]

Partial derivative

\begin{align*}
  \frac{\partial w(x)}{\partial x_i}=\sum_{j=1}^{d}
\end{align*}

Gradient oin $T$: \[ |\nabla w(x)|^2\le \|B_T^{-t}\|^2_{F}|\hat{\nabla}\hat{w}(\hat{x})|^2 \] with Frobenius norm $\|B_T^{-t}\|$

\section{Step $3$: Interpolation error on the reference cell}

\begin{theorem}
  Bramble-Hilbert lemma

  Let $T\subset\mathbb{R}^d$ a Lipschitz domain, $F$ a normed space, $\phi: H^m(T)\rightarrow F$
\end{theorem}

\section{Step $4$: Backward transformation}

\begin{align*}
  |\hat{u}|_{H^2(\hat{T})}=|\mathrm{det} B_T|^{-1/2}\|B_T^t\|
\end{align*}

\section{Geometrical parameters}

$h_T=$outer radius, $\rho_T=$inner radius, $\kappa_T=\frac{h_T}{\rho_T}=$aspect ratio

A family of meshes $\mathcal{T}_1$, $\mathcal{T}_2$, $\mathcal{T}_3,\ldots$ is called \textbf{shape regular} if $\max_{i}\max_{T\in\mathcal{T}_i}\kappa_T\le \kappa$

A family of meshes $\mathcal{T}_1$, $\mathcal{T}_2$, $\mathcal{T}_3,\ldots$ is called \textbf{quasi uniform} if $\frac{\max}{\min}\le \kappa$

\section{Spectral norm of transformation}

For the spectral norm of the affin linear transformation $\phi_T$

\section{Step $5$: Assembling together}

\[ \|\nabla(u-I_h u)\|^2_{\Omega}\le c\sum_{T\in\mathcal{T}_h}\|B_T ^{-1}\|^2_{F}\|B_T\|\ \]

Error estimates in the $L^2$ norm

\section{$L^2$ error estimates}

Are you interested in a ``weaker'' norm \[ \|u-u_h\|_{L^2(\Omega)} \] instead of \[ \|u-I_h u\|_{L^2(\Omega)}\le c_{\kappa}\bm{h^2}|u|H^2(\Omega)  \] ?

% desigualdad de poincar√©
\section{Duality argument}
\begin{itemize}
\item \textbf{Aim}: Derive error bound on \[\|u-u_h\|_{W} \] in a weaker norm, i.e. let $W$ be an Hilbert space with continuous embedding $V\subseteq W$, i.e. \[\|u\|_{W} \]
\end{itemize}


\begin{itemize}
\item Due to the continuous embedding $V\subseteq W$ it holds \[ W^{\prime}\subseteq V^\prime \]
  
\item Hence, $g\in S\subset V^\prime$ is a possible rhs in the dual problem:
  \[ z_g\in V\colon\quad A(\phi, z_g)=\langle g,\phi\rangle\quad\forall \phi\in V \]
 
\item Primal problem: \[ u\in V\colon\quad A(u,\phi)=\langle f,\phi\rangle. \]
\end{itemize}

\section{Aubin-Nitsche trick}
We arribe at:
\begin{theorem}
  Let $\Omega\subset\mathbb{R}^d, d\in\{2,3\}$, be a convex domain or a domain with $C^2$-boundary, $\{T_h\}$.
\end{theorem}

\section{Higher orden finite elements}

\begin{itemize}
\item FEM or order $r\ge1$: \[ P_r(\mathcal{T}_h)=\{\varphi\colon\Omega_h\rightarrow\mathbb{R}\colon \restr{\varphi}{T}\in P_r\forall T\in\mathcal{T}_h \} \]
\end{itemize}
% No necesariamente coercivo

\section{Error estimate for higher order finite elements}

\begin{theorem}
  We consider the Poisson problem, discretized with $P_r$ finite elments $(r\ge 1)$ on a family of shape regular meshes. If the solution $u$ has regularity $H^{r+1}$, then \[ \|\nabla(u-I_h u)\|_{\Omega}\le c_{\kappa}h^r|u|H^{r+1} \] %\ldots.
\end{theorem}

\section{Pro's  and contras of higher order finite elements}

\textbf{Pro's}:
\begin{itemize}
\item A better approximation property is expected due to better asymptotic behavoiur
  
\item Less degrees of freedom for a given accuaracy.
  
\item More local couplings in the stiffness matrix (can be advantageous for CPU reasons)
 
\end{itemize}

\textbf{Contra}:
\begin{itemize}
\item More regularity of the solution is necessary. Otherwise: reduction of accuracy \textbackslash order of convergence.
  
\item Stiffness matrix become more dense due to many couplings inside each elements

  
\item Robust linear solvers are usually more difficult.
\end{itemize}

\section{Accuracy of $Q_r$ elements}

\[ \varphi(x,y)=\sum_{i,j=0}^{r}\alpha_{ij}x^iy^j \]
\begin{itemize}
\item The nodal interpolation $\hat{I}$ in the reference quadirlataral \textbackslash hexaedral is exacts for polynomials of degree $\le r$
\end{itemize}

\section{Summary of Lecture $2$}

\begin{itemize}
\item FE for continuous, coercive bilinear forms are quasi-optimal with respect to discretization error:
\end{itemize}
\end{document}